<div class="auth-container">
  <!-- ×¨×§×¢ ××•× ×¤×© -->
  <div class="animated-background">
    <div class="floating-shape shape-1"></div>
    <div class="floating-shape shape-2"></div>
    <div class="floating-shape shape-3"></div>
    <div class="floating-shape shape-4"></div>
    <div class="floating-shape shape-5"></div>
  </div>

  <!-- ×ª×•×›×Ÿ ×”×¢××•×“ -->
  <div class="auth-content">
    <!-- ×œ×•×’×• ×•×›×•×ª×¨×ª -->
    <div class="auth-header">
      <div class="logo-container">
        <div class="logo-icon">ğŸ“</div>
        <h1 class="logo-text">TypePro</h1>
      </div>
      <p class="welcome-text">×”×¦×˜×¨×£ ××œ×™× ×• ×”×™×•×</p>
    </div>

    <!-- ×›×¨×˜×™×¡ ×¨×™×©×•× -->
    <mat-card class="auth-card">
      <mat-card-header class="card-header">
        <div class="header-icon">âœ¨</div>
        <mat-card-title class="card-title">
          @if (currentStep === 'form') {
            ×™×¦×™×¨×ª ×—×©×‘×•×Ÿ ×—×“×©
          } @else if (currentStep === 'email-verification') {
            ××™××•×ª ×›×ª×•×‘×ª ××™×™×œ
          } @else {
            ×¨×™×©×•× ×”×•×©×œ×
          }
        </mat-card-title>
        <mat-card-subtitle class="card-subtitle">
          @if (currentStep === 'form') {
            ×”××¨ ××ª ×”×§×‘×¦×™× ×©×œ×š ×œ×˜×§×¡×˜ ×‘×§×œ×•×ª
          } @else if (currentStep === 'email-verification') {
            ×”×–×Ÿ ××ª ×”×§×•×“ ×©× ×©×œ×— ×œ××™×™×œ ×©×œ×š
          } @else {
            ×‘×¨×•×š ×”×‘× ×œ××¢×¨×›×ª!
          }
        </mat-card-subtitle>
      </mat-card-header>

      <mat-card-content class="card-content">
        
        <!-- ×”×•×“×¢×•×ª -->
        @if (errorMessage) {
          <div class="error-message">
            <mat-icon class="error-icon">error</mat-icon>
            {{ errorMessage }}
          </div>
        }
        
        @if (successMessage) {
          <div class="success-message">
            <mat-icon class="success-icon">check_circle</mat-icon>
            {{ successMessage }}
          </div>
        }

        <!-- ×©×œ×‘ 1: ×˜×•×¤×¡ ×¨×™×©×•× -->
        @if (currentStep === 'form') {
          <form class="auth-form" (ngSubmit)="onRegister()">
            <!-- ×©× ××œ× -->
            <mat-form-field class="form-field" appearance="outline">
              <mat-label>×©× ××œ×</mat-label>
              <input 
                matInput 
                [(ngModel)]="form.name" 
                name="name"
                required
                placeholder="×”×›× ×¡ ×©× ××œ×"
              >
              <mat-icon matSuffix class="field-icon">person</mat-icon>
            </mat-form-field>

            <!-- ××™××™×™×œ -->
            <mat-form-field class="form-field" appearance="outline">
              <mat-label>×›×ª×•×‘×ª ××™××™×™×œ</mat-label>
              <input 
                matInput 
                type="email"
                [(ngModel)]="form.email" 
                name="email"
                required
                placeholder="example@email.com"
              >
              <mat-icon matSuffix class="field-icon">email</mat-icon>
            </mat-form-field>

            <!-- ×¡×™×¡××” -->
            <mat-form-field class="form-field" appearance="outline">
              <mat-label>×¡×™×¡××”</mat-label>
              <input 
                matInput 
                type="password"
                [(ngModel)]="form.password" 
                name="password"
                required
                placeholder="×œ×¤×—×•×ª 6 ×ª×•×•×™×, ××•×ª ×’×“×•×œ×” ×•×¡×¤×¨×”"
              >
              <mat-icon matSuffix class="field-icon">lock</mat-icon>
            </mat-form-field>

            <!-- ××™××•×ª ×¡×™×¡××” -->
            <mat-form-field class="form-field" appearance="outline">
              <mat-label>××™××•×ª ×¡×™×¡××”</mat-label>
              <input 
                matInput 
                type="password"
                [(ngModel)]="form.confirmPassword" 
                name="confirmPassword"
                required
                placeholder="×”×›× ×¡ ×¡×™×¡××” ×©×•×‘"
              >
              <mat-icon matSuffix class="field-icon">lock_clock</mat-icon>
            </mat-form-field>

            <!-- ×›×¤×ª×•×¨ ×©×œ×™×—×ª ×§×•×“ ××™××•×ª -->
            <button 
              mat-raised-button 
              type="submit" 
              class="auth-button register-button"
              [disabled]="!form.name || !form.email || !form.password || !form.confirmPassword || isLoading"
            >
              @if (!isLoading) {
                <mat-icon class="button-icon">email</mat-icon>
              } @else {
                <mat-spinner diameter="20"></mat-spinner>
              }
              <span>{{ isLoading ? '×©×•×œ×— ×§×•×“ ××™××•×ª...' : '×©×œ×— ×§×•×“ ××™××•×ª ×œ××™×™×œ' }}</span>
              <div class="button-ripple"></div>
            </button>
          </form>
        }

        <!-- ×©×œ×‘ 2: ××™××•×ª ××™×™×œ -->
        @if (currentStep === 'email-verification') {
          <form class="auth-form" (ngSubmit)="verifyEmailCode()">
            <div class="verification-info">
              <mat-icon class="info-icon">info</mat-icon>
              <p>×©×œ×—× ×• ×§×•×“ ××™××•×ª ×‘×Ÿ 6 ×¡×¤×¨×•×ª ×œ×›×ª×•×‘×ª: <strong>{{ form.email }}</strong></p>
            </div>

            <!-- ×§×•×“ ××™××•×ª -->
            <mat-form-field class="form-field" appearance="outline">
              <mat-label>×§×•×“ ××™××•×ª</mat-label>
              <input 
                matInput 
                [(ngModel)]="verificationCode" 
                name="verificationCode"
                required
                maxlength="6"
                placeholder="×”×–×Ÿ ×§×•×“ 6 ×¡×¤×¨×•×ª"
                (input)="errorMessage = ''; onVerificationCodeChange($event)"
                (paste)="onPasteVerificationCode($event)"
                type="text"
                inputmode="numeric"
                pattern="[0-9]*"
                autocomplete="one-time-code"
              >
              <mat-icon matSuffix class="field-icon">verified_user</mat-icon>
              @if (verificationCode && verificationCode.length === 6) {
                <mat-icon matSuffix class="field-icon success-icon">check_circle</mat-icon>
              }
            </mat-form-field>

            <!-- ×›×¤×ª×•×¨×™× -->
            <div class="verification-buttons">
              <button 
                mat-raised-button 
                type="submit" 
                class="auth-button verify-button"
                [disabled]="!verificationCode || verificationCode.length !== 6 || isLoading"
              >
                @if (!isLoading) {
                  <mat-icon class="button-icon">check</mat-icon>
                } @else {
                  <mat-spinner diameter="20"></mat-spinner>
                }
                <span>{{ isLoading ? '××××ª...' : '×××ª ×§×•×“' }}</span>
              </button>

              <button 
                mat-button 
                type="button" 
                class="secondary-button"
                (click)="resendCode()"
                [disabled]="isLoading"
              >
                <mat-icon class="button-icon">refresh</mat-icon>
                <span>×©×œ×— ×§×•×“ ×©×•×‘</span>
              </button>

              <button 
                mat-button 
                type="button" 
                class="secondary-button"
                (click)="goBack()"
                [disabled]="isLoading"
              >
                <mat-icon class="button-icon">arrow_back</mat-icon>
                <span>×—×–×•×¨</span>
              </button>
            </div>
          </form>
        }

        <!-- ×©×œ×‘ 3: ×¨×™×©×•× ×”×•×©×œ× -->
        @if (currentStep === 'completed') {
          <div class="completion-message">
            <mat-icon class="completion-icon">celebration</mat-icon>
            <h3>×”×¨×™×©×•× ×”×•×©×œ× ×‘×”×¦×œ×—×”!</h3>
            <p>××•×¢×‘×¨ ××•×ª×š ×œ×¢××•×“ ×”×‘×™×ª...</p>
            <mat-spinner diameter="30"></mat-spinner>
          </div>
        }

        <!-- ×§×™×©×•×¨ ×œ×”×ª×—×‘×¨×•×ª - ×¨×§ ×‘×©×œ×‘ ×”×¨××©×•×Ÿ -->
        @if (currentStep === 'form') {
          <div class="auth-footer">
            <p class="footer-text">
              ×›×‘×¨ ×™×© ×œ×š ×—×©×‘×•×Ÿ?
              <a routerLink="/login" class="auth-link">×”×ª×—×‘×¨ ×›××Ÿ</a>
            </p>
          </div>
        }
      </mat-card-content>
    </mat-card>

    <!-- ×ª×›×•× ×•×ª ×”××¢×¨×›×ª -->
    <div class="features-section">
      <div class="feature-item">
        <div class="feature-icon">ğŸš€</div>
        <div class="feature-text">××”×™×¨ ×•×™×¢×™×œ</div>
      </div>
      <div class="feature-item">
        <div class="feature-icon">ğŸ”’</div>
        <div class="feature-text">×××•×‘×˜×— ×œ×—×œ×•×˜×™×Ÿ</div>
      </div>
      <div class="feature-item">
        <div class="feature-icon">ğŸ’</div>
        <div class="feature-text">××™×›×•×ª ××¢×•×œ×”</div>
      </div>
    </div>
  </div>
</div>